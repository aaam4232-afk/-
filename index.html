<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø³ÙˆÙ‚ Ø¹Ø²Ø§Ù† Ø§Ù„Ù…ÙˆØ­Ø¯ ğŸ›’</title>
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#004d40">
    <meta name="apple-mobile-web-app-title" content="Ø³ÙˆÙ‚ Ø¹Ø²Ø§Ù†">
    
    <link rel="manifest" href="data:application/manifest+json,{%22name%22:%22%D8%B3%D9%88%D9%82%20%D8%B9%D8%B2%D8%A7%D9%86%20%D8%A7%D9%84%20%D9%85%D9%88%D8%AD%D8%AF%22,%22short_name%22:%22%D8%B3%D9%88%D9%82%20%D8%B9%D8%B2%D8%A7%D9%86%22,%22start_url%22:%22.%22,%22display%22:%22standalone%22,%22background_color%22:%22%23f4f7f6%22,%22theme_color%22:%22%23004d40%22,%22icons%22:[{%22src%22:%22https://cdn-icons-png.flaticon.com/512/3081/3081986.png%22,%22sizes%22:%22512x512%22,%22type%22:%22image/png%22}]}">

    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@500;800&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root { --primary: #004d40; --accent: #ff6d00; --bg: #f4f7f6; }
        body { font-family: 'Tajawal', sans-serif; background: var(--bg); margin: 0; padding: 0; overflow-x: hidden; touch-action: manipulation; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .header { background: var(--primary); color: white; padding: 30px 20px 45px; text-align: center; border-radius: 0 0 30px 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .header h1 { margin: 0; font-size: 1.7rem; font-weight: 800; }
        
        .main-container { padding: 0 15px; margin-top: -25px; }
        
        /* ÙƒØ±Øª Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .card { background: white; border-radius: 20px; padding: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .section-title { font-weight: 800; color: var(--primary); margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© */
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .btn-cat { 
            background: #fff; border: 1.5px solid #eee; border-radius: 18px; padding: 15px; 
            text-align: center; cursor: pointer; transition: 0.2s; 
            display: flex; flex-direction: column; align-items: center; gap: 8px;
        }
        .btn-cat:active { transform: scale(0.95); background: #f9f9f9; border-color: var(--primary); }
        .btn-cat span { font-size: 1.8rem; }
        .btn-cat b { font-size: 0.9rem; color: #333; }

        /* Ø­Ø§Ù„Ø© Ø§Ù„ÙØ­Øµ */
        .status { font-size: 0.7rem; padding: 3px 8px; border-radius: 8px; font-weight: bold; }
        .status.wait { color: #888; background: #f0f0f0; }
        .status.active { color: #2e7d32; background: #e8f5e9; }

        /* ØµÙØ­Ø§Øª Ø§Ù„Ø¹Ø±Ø¶ (Ø§Ù„ØªÙŠ ØªÙ…Ù†Ø¹ Ø§Ù„ØªØ¬Ù…Ø¯) */
        .page-overlay { 
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: var(--bg); z-index: 3000; overflow-y: auto; 
        }
        .top-nav { background: white; padding: 15px; display: flex; align-items: center; position: sticky; top: 0; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .back-btn { background: #eee; border: none; padding: 8px 18px; border-radius: 12px; cursor: pointer; font-family: inherit; font-weight: bold; }

        /* ÙƒØ±Øª Ø§Ù„Ø³Ù„Ø¹Ø© */
        .item-card { background: white; padding: 18px; border-radius: 18px; margin: 12px; border-right: 6px solid var(--accent); box-shadow: 0 4px 12px rgba(0,0,0,0.04); }
        .wa-button { 
            background: #25D366; color: white; text-decoration: none; display: flex; 
            align-items: center; justify-content: center; gap: 8px; padding: 12px; 
            border-radius: 15px; margin-top: 12px; font-weight: 800; font-size: 0.95rem;
        }
    </style>
</head>
<body>

<div class="header">
    <h1>Ø³ÙˆÙ‚ Ø¹Ø²Ø§Ù† Ø§Ù„Ù…ÙˆØ­Ø¯ ğŸ›’</h1>
    <p style="margin:5px 0 0; opacity:0.9; font-size:0.9rem;">Ø¯Ù„ÙŠÙ„Ùƒ Ø§Ù„Ø£ÙˆÙ„ Ù„Ù„ØªØ³ÙˆÙ‚ ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø¹Ø²Ø§Ù†</p>
</div>

<div class="main-container">
    <div class="card">
        <div class="section-title">ğŸ”¥ ØªØµÙØ­ Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª</div>
        <div class="btn-grid">
            <div class="btn-cat" onclick="openCat('Ù…Ø·Ø§Ø¹Ù… ÙˆÙƒÙØªÙŠØ±ÙŠØ§', 'ğŸ”')"><span>ğŸ”</span><b>Ø§Ù„Ù…Ø·Ø§Ø¹Ù…</b><div id="st-Ù…Ø·Ø§Ø¹Ù… ÙˆÙƒÙØªÙŠØ±ÙŠØ§" class="status wait">ÙØ­Øµ...</div></div>
            <div class="btn-cat" onclick="openCat('Ù…ÙˆØ§Ø¯ ØºØ°Ø§Ø¦ÙŠØ©', 'ğŸ')"><span>ğŸ</span><b>Ø§Ù„ØºØ°Ø§Ø¡</b><div id="st-Ù…ÙˆØ§Ø¯ ØºØ°Ø§Ø¦ÙŠØ©" class="status wait">ÙØ­Øµ...</div></div>
            <div class="btn-cat" onclick="openCat('Ù…ÙˆØ§Ø¯ Ø¨Ù†Ø§Ø¡ ÙˆØ³Ø¨Ø§ÙƒØ©', 'ğŸ—ï¸')"><span>ğŸ—ï¸</span><b>Ø§Ù„Ø¨Ù†Ø§Ø¡</b><div id="st-Ù…ÙˆØ§Ø¯ Ø¨Ù†Ø§Ø¡ ÙˆØ³Ø¨Ø§ÙƒØ©" class="status wait">ÙØ­Øµ...</div></div>
            <div class="btn-cat" onclick="openCat('Ù…ÙˆØ§Ø¯ ÙƒÙ‡Ø±Ø¨Ø§Ø¡', 'âš¡')"><span>âš¡</span><b>Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡</b><div id="st-Ù…ÙˆØ§Ø¯ ÙƒÙ‡Ø±Ø¨Ø§Ø¡" class="status wait">ÙØ­Øµ...</div></div>
        </div>
    </div>
    
    <button onclick="showLogin()" style="width:100%; padding:18px; border-radius:20px; border:none; background:#2c3e50; color:white; font-family:inherit; font-weight:800; cursor:pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">ğŸ” Ù„ÙˆØ­Ø© Ø¯Ø®ÙˆÙ„ Ø§Ù„ØªØ¬Ø§Ø±</button>
</div>

<div id="displayPage" class="page-overlay">
    <div class="top-nav">
        <button class="back-btn" onclick="closePage('displayPage')">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
        <h3 id="pgTitle" style="margin:0 15px 0 0; flex:1; font-weight:800; color:var(--primary);"></h3>
    </div>
    <div id="itemsList" style="padding-bottom: 30px;"></div>
</div>

<script>
    // ØªÙ‡ÙŠØ¦Ø© Firebase (ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ø¯ÙŠØ« Ø±Ø§Ø¨Ø· Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø®ØªÙ„ÙØ§Ù‹)
    const firebaseConfig = { databaseURL: "https://souq-tarim-default-rtdb.firebaseio.com/" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function closePage(id) { document.getElementById(id).style.display = 'none'; document.body.style.overflow = 'auto'; }

    function openCat(cat, icon) {
        document.getElementById('pgTitle').innerText = icon + " " + cat;
        const list = document.getElementById('itemsList');
        list.innerHTML = "<p style='text-align:center; padding:40px; color:#888;'>Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ø­Ù„Ø§Øª Ø¹Ø²Ø§Ù†...</p>";
        document.getElementById('displayPage').style.display = 'block';
        document.body.style.overflow = 'hidden';

        db.ref('Stores').orderByChild('category').equalTo(cat).once('value', (snap) => {
            const stores = snap.val() || {};
            db.ref('Products').once('value', (pSnap) => {
                list.innerHTML = "";
                const products = pSnap.val() || {};
                let found = false;

                Object.keys(stores).forEach(id => {
                    if (products[id]) {
                        Object.values(products[id]).forEach(item => {
                            found = true;
                            const msg = encodeURIComponent(Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…ØŒ Ø£Ø±ÙŠØ¯ Ø·Ù„Ø¨: ${item.name}\nØ§Ù„Ø³Ø¹Ø±: ${item.price}\nÙ…Ù† Ø³ÙˆÙ‚ Ø¹Ø²Ø§Ù† Ø§Ù„Ù…ÙˆØ­Ø¯);
                            list.innerHTML += `
                                <div class="item-card">
                                    <div style="display:flex; justify-content:space-between; align-items:start;">
                                        <b style="font-size:1.1rem; color:#2c3e50;">${item.name}</b>
                                        <span style="color:var(--accent); font-weight:800; font-size:1.1rem;">${item.price} Ø±ÙŠØ§Ù„</span>
                                    </div>
                                    <div style="font-size:0.85rem; color:#666; margin-top:6px;">ğŸª Ø§Ù„Ù…Ø­Ù„: <b>${stores[id].name}</b></div>
                                    <a href="https://wa.me/967${stores[id].phone}?text=${msg}" class="wa-button">ğŸ’¬ Ø§Ø·Ù„Ø¨ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</a>
                                </div>`;
                        });
                    }
                });
                if(!found) list.innerHTML = "<div style='text-align:center; padding:50px; color:#999;'>ğŸ˜´ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ø±ÙˆØ¶ Ù…ØªÙˆÙØ±Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù….</div>";
            });
        });
    }

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ (ÙØ­Øµ Ø§Ù„Ø¹Ø±ÙˆØ¶)
    function syncStatus() {
        db.ref('Products').on('value', (pSnap) => {
            const allProducts = pSnap.val() || {};
            db.ref('Stores').once('value', (sSnap) => {
                const allStores = sSnap.val() || {};
                ['Ù…Ø·Ø§Ø¹Ù… ÙˆÙƒÙØªÙŠØ±ÙŠØ§', 'Ù…ÙˆØ§Ø¯ ØºØ°Ø§Ø¦ÙŠØ©', 'Ù…ÙˆØ§Ø¯ Ø¨Ù†Ø§Ø¡ ÙˆØ³Ø¨Ø§ÙƒØ©', 'Ù…ÙˆØ§Ø¯ ÙƒÙ‡Ø±Ø¨Ø§Ø¡'].forEach(c => {
                    let has = false;
                    Object.keys(allStores).forEach(sid => {
                        if (allStores[sid].category === c && allProducts[sid]) has = true;
                    });
                    const el = document.getElementById('st-'+c);
                    if(el) {
                        el.innerText = has ? "âœ… Ù…ØªØ§Ø­" : "Ù„Ø§ ÙŠÙˆØ¬Ø¯";
                        el.className = "status " + (has ? "active" : "wait");
                    }
                });
            });
        });
    }
    syncStatus();

    function showLogin() { alert("Ø³ÙŠØªÙ… ÙØªØ­ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„ØªØ§Ø¬Ø± ÙÙŠ ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¯Ù…"); }
</script>
</body>
</html><!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø³ÙˆÙ‚ Ø¹Ø²Ø§Ù† Ø§Ù„Ù…ÙˆØ­Ø¯ ğŸ›’</title>
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#004d40">
    <meta name="apple-mobile-web-app-title" content="Ø³ÙˆÙ‚ Ø¹Ø²Ø§Ù†">
    
    <link rel="manifest" href="data:application/manifest+json,{%22name%22:%22%D8%B3%D9%88%D9%82%20%D8%B9%D8%B2%D8%A7%D9%86%20%D8%A7%D9%84%20%D9%85%D9%88%D8%AD%D8%AF%22,%22short_name%22:%22%D8%B3%D9%88%D9%82%20%D8%B9%D8%B2%D8%A7%D9%86%22,%22start_url%22:%22.%22,%22display%22:%22standalone%22,%22background_color%22:%22%23f4f7f6%22,%22theme_color%22:%22%23004d40%22,%22icons%22:[{%22src%22:%22https://cdn-icons-png.flaticon.com/512/3081/3081986.png%22,%22sizes%22:%22512x512%22,%22type%22:%22image/png%22}]}">

    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@500;800&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root { --primary: #004d40; --accent: #ff6d00; --bg: #f4f7f6; }
        body { font-family: 'Tajawal', sans-serif; background: var(--bg); margin: 0; padding: 0; overflow-x: hidden; touch-action: manipulation; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .header { background: var(--primary); color: white; padding: 30px 20px 45px; text-align: center; border-radius: 0 0 30px 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .header h1 { margin: 0; font-size: 1.7rem; font-weight: 800; }
        
        .main-container { padding: 0 15px; margin-top: -25px; }
        
        /* ÙƒØ±Øª Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .card { background: white; border-radius: 20px; padding: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .section-title { font-weight: 800; color: var(--primary); margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© */
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .btn-cat { 
            background: #fff; border: 1.5px solid #eee; border-radius: 18px; padding: 15px; 
            text-align: center; cursor: pointer; transition: 0.2s; 
            display: flex; flex-direction: column; align-items: center; gap: 8px;
        }
        .btn-cat:active { transform: scale(0.95); background: #f9f9f9; border-color: var(--primary); }
        .btn-cat span { font-size: 1.8rem; }
        .btn-cat b { font-size: 0.9rem; color: #333; }

        /* Ø­Ø§Ù„Ø© Ø§Ù„ÙØ­Øµ */
        .status { font-size: 0.7rem; padding: 3px 8px; border-radius: 8px; font-weight: bold; }
        .status.wait { color: #888; background: #f0f0f0; }
        .status.active { color: #2e7d32; background: #e8f5e9; }

        /* ØµÙØ­Ø§Øª Ø§Ù„Ø¹Ø±Ø¶ (Ø§Ù„ØªÙŠ ØªÙ…Ù†Ø¹ Ø§Ù„ØªØ¬Ù…Ø¯) */
        .page-overlay { 
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: var(--bg); z-index: 3000; overflow-y: auto; 
        }
        .top-nav { background: white; padding: 15px; display: flex; align-items: center; position: sticky; top: 0; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .back-btn { background: #eee; border: none; padding: 8px 18px; border-radius: 12px; cursor: pointer; font-family: inherit; font-weight: bold; }

        /* ÙƒØ±Øª Ø§Ù„Ø³Ù„Ø¹Ø© */
        .item-card { background: white; padding: 18px; border-radius: 18px; margin: 12px; border-right: 6px solid var(--accent); box-shadow: 0 4px 12px rgba(0,0,0,0.04); }
        .wa-button { 
            background: #25D366; color: white; text-decoration: none; display: flex; 
            align-items: center; justify-content: center; gap: 8px; padding: 12px; 
            border-radius: 15px; margin-top: 12px; font-weight: 800; font-size: 0.95rem;
        }
    </style>
</head>
<body>

<div class="header">
    <h1>Ø³ÙˆÙ‚ Ø¹Ø²Ø§Ù† Ø§Ù„Ù…ÙˆØ­Ø¯ ğŸ›’</h1>
    <p style="margin:5px 0 0; opacity:0.9; font-size:0.9rem;">Ø¯Ù„ÙŠÙ„Ùƒ Ø§Ù„Ø£ÙˆÙ„ Ù„Ù„ØªØ³ÙˆÙ‚ ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø¹Ø²Ø§Ù†</p>
</div>

<div class="main-container">
    <div class="card">
        <div class="section-title">ğŸ”¥ ØªØµÙØ­ Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª</div>
        <div class="btn-grid">
            <div class="btn-cat" onclick="openCat('Ù…Ø·Ø§Ø¹Ù… ÙˆÙƒÙØªÙŠØ±ÙŠØ§', 'ğŸ”')"><span>ğŸ”</span><b>Ø§Ù„Ù…Ø·Ø§Ø¹Ù…</b><div id="st-Ù…Ø·Ø§Ø¹Ù… ÙˆÙƒÙØªÙŠØ±ÙŠØ§" class="status wait">ÙØ­Øµ...</div></div>
            <div class="btn-cat" onclick="openCat('Ù…ÙˆØ§Ø¯ ØºØ°Ø§Ø¦ÙŠØ©', 'ğŸ')"><span>ğŸ</span><b>Ø§Ù„ØºØ°Ø§Ø¡</b><div id="st-Ù…ÙˆØ§Ø¯ ØºØ°Ø§Ø¦ÙŠØ©" class="status wait">ÙØ­Øµ...</div></div>
            <div class="btn-cat" onclick="openCat('Ù…ÙˆØ§Ø¯ Ø¨Ù†Ø§Ø¡ ÙˆØ³Ø¨Ø§ÙƒØ©', 'ğŸ—ï¸')"><span>ğŸ—ï¸</span><b>Ø§Ù„Ø¨Ù†Ø§Ø¡</b><div id="st-Ù…ÙˆØ§Ø¯ Ø¨Ù†Ø§Ø¡ ÙˆØ³Ø¨Ø§ÙƒØ©" class="status wait">ÙØ­Øµ...</div></div>
            <div class="btn-cat" onclick="openCat('Ù…ÙˆØ§Ø¯ ÙƒÙ‡Ø±Ø¨Ø§Ø¡', 'âš¡')"><span>âš¡</span><b>Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡</b><div id="st-Ù…ÙˆØ§Ø¯ ÙƒÙ‡Ø±Ø¨Ø§Ø¡" class="status wait">ÙØ­Øµ...</div></div>
        </div>
    </div>
    
    <button onclick="showLogin()" style="width:100%; padding:18px; border-radius:20px; border:none; background:#2c3e50; color:white; font-family:inherit; font-weight:800; cursor:pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">ğŸ” Ù„ÙˆØ­Ø© Ø¯Ø®ÙˆÙ„ Ø§Ù„ØªØ¬Ø§Ø±</button>
</div>

<div id="displayPage" class="page-overlay">
    <div class="top-nav">
        <button class="back-btn" onclick="closePage('displayPage')">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
        <h3 id="pgTitle" style="margin:0 15px 0 0; flex:1; font-weight:800; color:var(--primary);"></h3>
    </div>
    <div id="itemsList" style="padding-bottom: 30px;"></div>
</div>

<script>
    // ØªÙ‡ÙŠØ¦Ø© Firebase (ØªØ£ÙƒØ¯ Ù…Ù† ØªØ­Ø¯ÙŠØ« Ø±Ø§Ø¨Ø· Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø®ØªÙ„ÙØ§Ù‹)
    const firebaseConfig = { databaseURL: "https://souq-tarim-default-rtdb.firebaseio.com/" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function closePage(id) { document.getElementById(id).style.display = 'none'; document.body.style.overflow = 'auto'; }

    function openCat(cat, icon) {
        document.getElementById('pgTitle').innerText = icon + " " + cat;
        const list = document.getElementById('itemsList');
        list.innerHTML = "<p style='text-align:center; padding:40px; color:#888;'>Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ø­Ù„Ø§Øª Ø¹Ø²Ø§Ù†...</p>";
        document.getElementById('displayPage').style.display = 'block';
        document.body.style.overflow = 'hidden';

        db.ref('Stores').orderByChild('category').equalTo(cat).once('value', (snap) => {
            const stores = snap.val() || {};
            db.ref('Products').once('value', (pSnap) => {
                list.innerHTML = "";
                const products = pSnap.val() || {};
                let found = false;

                Object.keys(stores).forEach(id => {
                    if (products[id]) {
                        Object.values(products[id]).forEach(item => {
                            found = true;
                            const msg = encodeURIComponent(Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ…ØŒ Ø£Ø±ÙŠØ¯ Ø·Ù„Ø¨: ${item.name}\nØ§Ù„Ø³Ø¹Ø±: ${item.price}\nÙ…Ù† Ø³ÙˆÙ‚ Ø¹Ø²Ø§Ù† Ø§Ù„Ù…ÙˆØ­Ø¯);
                            list.innerHTML += `
                                <div class="item-card">
                                    <div style="display:flex; justify-content:space-between; align-items:start;">
                                        <b style="font-size:1.1rem; color:#2c3e50;">${item.name}</b>
                                        <span style="color:var(--accent); font-weight:800; font-size:1.1rem;">${item.price} Ø±ÙŠØ§Ù„</span>
                                    </div>
                                    <div style="font-size:0.85rem; color:#666; margin-top:6px;">ğŸª Ø§Ù„Ù…Ø­Ù„: <b>${stores[id].name}</b></div>
                                    <a href="https://wa.me/967${stores[id].phone}?text=${msg}" class="wa-button">ğŸ’¬ Ø§Ø·Ù„Ø¨ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</a>
                                </div>`;
                        });
                    }
                });
                if(!found) list.innerHTML = "<div style='text-align:center; padding:50px; color:#999;'>ğŸ˜´ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ø±ÙˆØ¶ Ù…ØªÙˆÙØ±Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù….</div>";
            });
        });
    }

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ (ÙØ­Øµ Ø§Ù„Ø¹Ø±ÙˆØ¶)
    function syncStatus() {
        db.ref('Products').on('value', (pSnap) => {
            const allProducts = pSnap.val() || {};
            db.ref('Stores').once('value', (sSnap) => {
                const allStores = sSnap.val() || {};
                ['Ù…Ø·Ø§Ø¹Ù… ÙˆÙƒÙØªÙŠØ±ÙŠØ§', 'Ù…ÙˆØ§Ø¯ ØºØ°Ø§Ø¦ÙŠØ©', 'Ù…ÙˆØ§Ø¯ Ø¨Ù†Ø§Ø¡ ÙˆØ³Ø¨Ø§ÙƒØ©', 'Ù…ÙˆØ§Ø¯ ÙƒÙ‡Ø±Ø¨Ø§Ø¡'].forEach(c => {
                    let has = false;
                    Object.keys(allStores).forEach(sid => {
                        if (allStores[sid].category === c && allProducts[sid]) has = true;
                    });
                    const el = document.getElementById('st-'+c);
                    if(el) {
                        el.innerText = has ? "âœ… Ù…ØªØ§Ø­" : "Ù„Ø§ ÙŠÙˆØ¬Ø¯";
                        el.className = "status " + (has ? "active" : "wait");
                    }
                });
            });
        });
    }
    syncStatus();

    function showLogin() { alert("Ø³ÙŠØªÙ… ÙØªØ­ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„ØªØ§Ø¬Ø± ÙÙŠ ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¯Ù…"); }
</script>
</body>
</html>